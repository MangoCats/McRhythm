# TC-I-P1-050-01: Size Targets Consistent Across Workflows

**Test ID:** TC-I-P1-050-01
**Test Type:** Integration Test
**Requirement:** REQ-CE-P1-050
**Priority:** HIGHEST
**Estimated Effort:** 5 minutes to write + implement

---

## Test Specification

**Scope:** Cross-file consistency verification (6 workflow files)

**Setup:** All 6 workflow files updated with size targets

**Given:**
- .claude/commands/commit.md contains size targets
- .claude/commands/think.md contains size targets
- .claude/commands/plan.md contains size targets
- .claude/commands/doc-name.md contains size targets
- .claude/commands/archive.md contains size targets
- .claude/commands/archive-plan.md contains size targets

**When:** Size targets extracted from all files

**Then:** Size targets are consistent (same values across workflows where applicable)

**Verify:**
- Executive summary target: <300 lines (all workflows)
- Detailed sections target: <300 lines (all workflows)
- Commit message target: <10 lines (commit.md only)

**Pass Criteria:**
- All 6 workflows reference "300 lines" for section size
- No contradictory values (e.g., one says <300, another says <500)
- Values match those specified in CLAUDE.md verbosity standards

**Fail Criteria:**
- Workflows have different threshold values
- Some workflows missing size targets entirely
- Values conflict with CLAUDE.md

---

## Test Procedure

### Automated Execution

```bash
#!/bin/bash
# Integration test: Size target consistency

WORKFLOWS=(
    ".claude/commands/commit.md"
    ".claude/commands/think.md"
    ".claude/commands/plan.md"
    ".claude/commands/doc-name.md"
    ".claude/commands/archive.md"
    ".claude/commands/archive-plan.md"
)

FAILED=0

echo "Testing size target consistency across workflows..."

# Test 1: All workflows mention "300 lines" for sections
for file in "${WORKFLOWS[@]}"; do
    if grep -q "300 lines" "$file"; then
        echo "PASS: $file mentions 300-line threshold"
    else
        echo "FAIL: $file does NOT mention 300-line threshold"
        FAILED=1
    fi
done

# Test 2: Extract all numeric thresholds and check for conflicts
echo ""
echo "Extracting all numeric thresholds..."
for file in "${WORKFLOWS[@]}"; do
    echo "From $file:"
    grep -oP '< *\d+ lines' "$file" | sort -u
done

# Test 3: Verify consistency with CLAUDE.md
echo ""
echo "Verifying consistency with CLAUDE.md..."
if grep -q "Detailed sections: <300 lines" CLAUDE.md; then
    echo "PASS: CLAUDE.md defines 300-line standard"
else
    echo "FAIL: CLAUDE.md missing 300-line standard"
    FAILED=1
fi

if [ $FAILED -eq 0 ]; then
    echo ""
    echo "ALL TESTS PASSED: TC-I-P1-050-01"
    exit 0
else
    echo ""
    echo "SOME TESTS FAILED: TC-I-P1-050-01"
    exit 1
fi
```

### Manual Verification

1. Open all 6 workflow files in editor (split view or tabs)
2. Search for "lines" in each file
3. Compare numeric values:
   - Executive summaries: all should say <300 lines
   - Detailed sections: all should say <300 lines
   - Full documents: may vary (archival, context-specific)
4. Cross-reference with CLAUDE.md "Document Generation Verbosity Standards"
5. Verify no contradictions

---

## Test Data

**Input Files:**
- CLAUDE.md (reference standard)
- 6 workflow files (.claude/commands/*.md)

**Expected Consistency:**
```
CLAUDE.md:          Executive summaries: <300 lines
                    Detailed sections: <300 lines

commit.md:          Commit messages: <10 lines
think.md:           Executive summary: <300 lines
plan.md:            Executive summary: <500 lines (exception - plan summaries longer)
doc-name.md:        N/A (no document generation)
archive.md:         Archive entries: <50 lines
archive-plan.md:    Archive entries: <50 lines
```

**Note:** plan.md has <500 line target for summaries (exception allowed, documented in spec)

---

## Integration Points

**Files Under Test:**
- CLAUDE.md (master standard)
- .claude/commands/commit.md
- .claude/commands/think.md
- .claude/commands/plan.md
- .claude/commands/doc-name.md
- .claude/commands/archive.md
- .claude/commands/archive-plan.md

**Dependencies:**
- TC-U-P1-040-01 (CLAUDE.md verbosity standards exist)
- TC-U-P1-050-01 (all workflows updated)

---

## Pass Conditions (Detailed)

**Strict Consistency:**
- Executive summary: <300 lines in CLAUDE.md, think.md, commit.md
- Detailed sections: <300 lines in all workflows that generate sections
- Plan summary: <500 lines (documented exception)

**Acceptable Variations:**
- Commit messages: <10 lines (specific to commit workflow)
- Archive entries: <50 lines (specific to archive workflows)
- Context-specific targets allowed IF documented and justified

**Failure Triggers:**
- Contradictory values (one says <300, another <400 for same thing)
- Missing targets in files that should have them
- Typos (e.g., "< 30 lines" instead of "<300 lines")

---

## Notes

**Rationale for Integration Test:**
- Consistency critical for user experience (predictable AI behavior)
- Easy to introduce inconsistency when updating multiple files
- Automated test catches drift over time

**Known Limitations:**
- Does not verify values are "correct" (only consistent)
- Does not verify AI actually follows targets (behavioral test separate)
- Allows documented exceptions (plan.md <500 lines)

**Design Decisions:**
- Test allows context-specific variations (commit <10, archive <50)
- Test references CLAUDE.md as authoritative source
- Test is lenient on exact phrasing (searches for "300 lines" pattern)

**Maintenance:**
- If standards change (e.g., <300 â†’ <400), update this test
- If new workflows added, update WORKFLOWS array
- Re-run after any verbosity standard changes

**Revision History:**
- 2025-10-25: Initial specification
