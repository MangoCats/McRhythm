{
  "document": "SPEC002-crossfade.md",
  "tier": 2,
  "total_edits": 14,
  "priority_breakdown": {
    "HIGH": 5,
    "MEDIUM": 6,
    "LOW": 3
  },
  "estimated_line_reduction": 0,
  "summary": "Add references to SPEC016 mixer implementation and SPEC017 tick timing. Critical discrepancies with tick storage.",
  "edits": [
    {
      "edit_id": "EDIT-SPEC002-001",
      "priority": "HIGH",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Implementation Algorithm",
        "lines": "243"
      },
      "current_content": "[XFD-IMPL-020] Pseudocode section ends",
      "new_content": "[XFD-IMPL-020] Pseudocode section ends\n\nSee [SPEC016 Decoder Buffer Design - Mixer](SPEC016-decoder_buffer_design.md#mixer) for implementation of crossfade mixing with overlapping passages ([DBD-MIX-040]).",
      "rationale": "SPEC016 defines HOW mixer implements crossfade overlap; SPEC002 defines WHEN overlap occurs",
      "status": "READY",
      "references_to_spec016_17": [
        "DBD-MIX-040"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "Documentation-only change"
    },
    {
      "edit_id": "EDIT-SPEC002-002",
      "priority": "MEDIUM",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Queue Entry Timing Specification",
        "lines": "980"
      },
      "current_content": "[XFD-QUEUE-030] Timing values as unsigned integer milliseconds",
      "new_content": "[XFD-QUEUE-030] Timing values as unsigned integer milliseconds\n\nSee [SPEC017 Sample Rate Conversion - API Representation](SPEC017-sample_rate_conversion.md#api-representation) for conversion between milliseconds (API) and ticks (internal storage, [SRC-API-020]: ms * 28224).",
      "rationale": "SPEC017 defines authoritative milliseconds-to-ticks conversion",
      "status": "READY",
      "references_to_spec016_17": [
        "SRC-API-020",
        "SRC-API-030"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "Documentation-only change"
    },
    {
      "edit_id": "EDIT-SPEC002-003",
      "priority": "CRITICAL",
      "type": "ALIGN_WITH_NEW_DESIGN",
      "location": {
        "section": "Database Storage",
        "lines": "1025-1033"
      },
      "current_content": "[XFD-DB-010] Timing points stored as seconds (REAL, nullable) in passages table",
      "new_content": "[XFD-DB-010] **CORRECTION:** Database stores timing as INTEGER ticks, not seconds.\n\nSee [SPEC017 Database Storage](SPEC017-sample_rate_conversion.md#database-storage) for tick-based storage format:\n- [SRC-DB-011]: start_time_ticks (INTEGER NOT NULL)\n- [SRC-DB-012]: fade_in_start_ticks (INTEGER)\n- [SRC-DB-013]: lead_in_start_ticks (INTEGER)\n- [SRC-DB-014]: lead_out_start_ticks (INTEGER)\n- [SRC-DB-015]: fade_out_start_ticks (INTEGER)\n- [SRC-DB-016]: end_time_ticks (INTEGER NOT NULL)\n\nConversion: ticks = seconds * 28,224,000 ([SRC-TICK-020])",
      "rationale": "SPEC002 contains INCORRECT information; SPEC017 specifies tick-based storage",
      "status": "BLOCKED_ON_T1_APPROVAL",
      "references_to_spec016_17": [
        "SRC-DB-011",
        "SRC-DB-012",
        "SRC-DB-013",
        "SRC-DB-014",
        "SRC-DB-015",
        "SRC-DB-016",
        "SRC-TICK-020"
      ],
      "implementation_impact": "MAJOR",
      "implementation_notes": "BLOCKED: Tick-based database storage requires Tier 1 approval for schema change"
    },
    {
      "edit_id": "EDIT-SPEC002-004",
      "priority": "MEDIUM",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Volume Calculations",
        "lines": "785"
      },
      "current_content": "[XFD-VOL-010] Final Output = (Passage A Audio \u00d7 A Volume) + (Passage B Audio \u00d7 B Volume)",
      "new_content": "[XFD-VOL-010] Final Output = (Passage A Audio \u00d7 A Volume) + (Passage B Audio \u00d7 B Volume)\n\nSee [SPEC016 Mixer](SPEC016-decoder_buffer_design.md#mixer) for implementation details of volume mixing during crossfade ([DBD-MIX-040]).",
      "rationale": "SPEC016 mixer implements this exact calculation",
      "status": "READY",
      "references_to_spec016_17": [
        "DBD-MIX-040"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "Documentation-only change"
    },
    {
      "edit_id": "EDIT-SPEC002-005",
      "priority": "LOW",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Volume Fade Update Frequency",
        "lines": "661"
      },
      "current_content": "[Configuration] volume_fade_update_period (default 10ms)",
      "new_content": "[Configuration] volume_fade_update_period (default 10ms)\n\nNote: This is distinct from [SPEC016 DBD-PARAM-040] output_refill_period (90ms), which controls mixer-to-output ring buffer fills. Volume updates occur more frequently for smooth fade curves.",
      "rationale": "Clarify relationship between two different timing parameters",
      "status": "READY",
      "references_to_spec016_17": [
        "DBD-PARAM-040"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "Documentation-only change"
    },
    {
      "edit_id": "EDIT-SPEC002-006",
      "priority": "MEDIUM",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Pause and Resume Behavior",
        "lines": "685"
      },
      "current_content": "[XFD-PAUS-010] Pause (immediate) and resume (fade-in) behavior",
      "new_content": "[XFD-PAUS-010] Pause (immediate) and resume (fade-in) behavior\n\nSee [SPEC016 Mixer - Pause Mode](SPEC016-decoder_buffer_design.md#mixer) for mixer implementation of pause behavior:\n- [DBD-MIX-050]: Exponential decay output during pause\n- [DBD-MIX-051]: pause_decay_factor ([DBD-PARAM-090], default 0.9999)\n- [DBD-MIX-052]: pause_decay_floor ([DBD-PARAM-100], default 0.0001)",
      "rationale": "SPEC002 defines pause behavior; SPEC016 implements it with specific parameters",
      "status": "READY",
      "references_to_spec016_17": [
        "DBD-MIX-050",
        "DBD-MIX-051",
        "DBD-MIX-052",
        "DBD-PARAM-090",
        "DBD-PARAM-100"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "Documentation-only change"
    },
    {
      "edit_id": "EDIT-SPEC002-007",
      "priority": "CRITICAL",
      "type": "ALIGN_WITH_NEW_DESIGN",
      "location": {
        "section": "Implementation Notes - Timing Precision",
        "lines": "764-773"
      },
      "current_content": "[XFD-IMPL-140] Timing precision: All calculations use floating-point seconds",
      "new_content": "[XFD-IMPL-140] **CORRECTION:** Timing precision uses tick-based representation (not floating-point seconds).\n\nSee [SPEC017 Problem Statement](SPEC017-sample_rate_conversion.md#problem-statement):\n- [SRC-PROB-020]: Floating-point seconds introduce cumulative rounding errors\n- [SRC-SOL-010]: Use i64 ticks for lossless precision\n- [SRC-TICK-020]: tick_rate = 28,224,000 Hz (LCM of common sample rates)\n- [SRC-TICK-030]: One tick \u2248 35.4 nanoseconds\n\nInternal timing uses ticks; floating-point may be used for logging/display only.",
      "rationale": "SPEC017 specifies tick-based timing to avoid floating-point rounding errors",
      "status": "BLOCKED_ON_T1_APPROVAL",
      "references_to_spec016_17": [
        "SRC-PROB-020",
        "SRC-SOL-010",
        "SRC-TICK-020",
        "SRC-TICK-030"
      ],
      "implementation_impact": "MAJOR",
      "implementation_notes": "BLOCKED: Crossfade timing implementation must use ticks instead of floating-point"
    },
    {
      "edit_id": "EDIT-SPEC002-008",
      "priority": "MEDIUM",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Timing Point Definitions",
        "lines": "80"
      },
      "current_content": "End of Point Definitions section",
      "new_content": "End of Point Definitions section\n\n**Database storage:** All timing points stored as INTEGER ticks (not seconds). See [SPEC017 Database Storage](SPEC017-sample_rate_conversion.md#database-storage) for field definitions ([SRC-DB-011] through [SRC-DB-016]).",
      "rationale": "Timing points section should acknowledge database storage format",
      "status": "BLOCKED_ON_T1_APPROVAL",
      "references_to_spec016_17": [
        "SRC-DB-011",
        "SRC-DB-012",
        "SRC-DB-013",
        "SRC-DB-014",
        "SRC-DB-015",
        "SRC-DB-016"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "BLOCKED: References tick storage pending Tier 1 approval"
    },
    {
      "edit_id": "EDIT-SPEC002-009",
      "priority": "LOW",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Fade Behavior During Crossfade",
        "lines": "778"
      },
      "current_content": "[XFD-FADE-010] Fades operate independently of crossfade overlap",
      "new_content": "[XFD-FADE-010] Fades operate independently of crossfade overlap\n\nSee [SPEC016 Fade In/Out handlers](SPEC016-decoder_buffer_design.md#fade-inout-handlers) for fade curve application implementation:\n- [DBD-FADE-030]: Fade-in curve application\n- [DBD-FADE-050]: Fade-out curve application",
      "rationale": "SPEC002 defines fade behavior; SPEC016 implements it",
      "status": "READY",
      "references_to_spec016_17": [
        "DBD-FADE-030",
        "DBD-FADE-050"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "Documentation-only change"
    },
    {
      "edit_id": "EDIT-SPEC002-010",
      "priority": "LOW",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Pre-Loading Strategy",
        "lines": "467"
      },
      "current_content": "[XFD-IMPL-070] Pre-load buffer time (5 seconds before crossfade)",
      "new_content": "[XFD-IMPL-070] Pre-load buffer time (5 seconds before crossfade)\n\nNote: 5-second pre-load buffer is 1/3 of [SPEC016 DBD-PARAM-070] playout_ringbuffer_size (15.01 seconds @ 44.1kHz). See [SPEC016 Operating Parameters](SPEC016-decoder_buffer_design.md#operating-parameters).",
      "rationale": "Pre-load timing related to buffer size parameter",
      "status": "READY",
      "references_to_spec016_17": [
        "DBD-PARAM-070"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "Documentation-only change"
    },
    {
      "edit_id": "EDIT-SPEC002-011",
      "priority": "MEDIUM",
      "type": "ADD_REFERENCE",
      "location": {
        "section": "Related Documentation",
        "lines": "7"
      },
      "current_content": "> **Related Documentation:** [Architecture](SPEC001-architecture.md) | [Single Stream Playback](SPEC013-single_stream_playback.md) | [Single Stream Design](SPEC014-single_stream_design.md)",
      "new_content": "> **Related Documentation:** [Architecture](SPEC001-architecture.md) | [Single Stream Playback](SPEC013-single_stream_playback.md) | [Single Stream Design](SPEC014-single_stream_design.md) | [Decoder Buffer Design](SPEC016-decoder_buffer_design.md) | [Sample Rate Conversion](SPEC017-sample_rate_conversion.md)",
      "rationale": "Add SPEC016/SPEC017 to related documentation",
      "status": "READY",
      "references_to_spec016_17": [
        "SPEC016",
        "SPEC017"
      ],
      "implementation_impact": "NONE",
      "implementation_notes": "Documentation-only change"
    }
  ]
}